<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="css/cssForRegister.css" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
    <title>הרשמה</title>
</head>


<body class="color">

    <header>
        <h1> צעד למען הגיל השלישי </h1>
        <img class="logo" src="img/logo.png" width="100px" height="100px">
    </header> <br>

    <main>

        <div class="container col-sm-7">
            <form action="" method="post" id="regForm" class="bcg">
               
                <div class="col-sm-10"> <!-- first page -->
                    <h1> הרשמה למערכת </h1> 
                    <div class="tab">

                        <label> שם פרטי</label> <input class="form-control" type="text" name="firstname" placeholder="גאיה" > <br>
                        <label> שם משפחה </label> <input class="form-control" type="text" name="lastname" placeholder="לוי"  > <br>
                        <label> כתובת מייל </label> <input class="form-control" type="email" name="email" placeholder="gaya@example.com"    > <br>
                        <label> מספר טלפון</label> <input class="form-control" type="tel" name="phone" placeholder="054555555" oninput="this.value = this.value.replace(/[^0-9]/g, '');" maxlength="10"> <br>

                        <div class="row">
                            <div class="col-sm-6"> 
                                <label> תאריך לידה </label> <input class="form-control" type="date" name="birth"  ><br>
                            </div>

                            <div class="col-sm-6">
                                <label for="gender"> מגדר </label><br>
                                <select class="form-select" id="gender" name="gender"  >
                                    <option value="" disabled selected> בחירת מגדר </option>
                                    <option value="1">נקבה</option>
                                    <option value="2">זכר</option>
                                    <option value="3">אחר</option>
                                </select><br>
                            </div>

                            <div class="col-sm-6">
                                <label>עיר</label> <input class="form-control" type="text" name="city" placeholder="תל אביב"  > <br>    
                                <label>רחוב</label> <input class="form-control" type="text" name="street" placeholder="הגליל"  > <br>
                            </div>

                            <div class="col-sm-6">
                                <label>מספר בית</label> <input class="form-control" type="text" name="s_num" placeholder="12" oninput="this.value = this.value.replace(/[^0-9]/g, '');" maxlength="4"> <br>
                                <label>מיקוד</label> <input class="form-control" type="text" name="zip" placeholder="7540231" oninput="this.value = this.value.replace(/[^0-9]/g, '');" maxlength="7"> <br>
                            </div>
                        </div> 

                            <label> הכנס סיסמה</label> <input class="form-control" type="password" name="password"> <br>
                            <label> אשר סיסמה</label> <input class="form-control" type="password" name="confirm_password"> <br>
                            <label for="avatar">העלאת תמונת פרופיל</label> <input class="form-control" type="file" name="avatar" accept="image/png, image/jpeg" style="width:50%"> 
                        <br>
                        
                        <div class="form-check form-switch form-switch-md form-check-reverse">
                            <input class="form-check-input" type="checkbox" role="switch" id="studentCheckbox" checked>
                            <label class="form-check-label" for="studentCheckbox">אני סטודנט</label>
                        </div><br>
                    </div>
                </div>
                
                <div class="col-sm-10"> <!-- second page -->
                    
                    <div class="tab">
                        <h3> פרטי סטודנט </h3>
                        <label> מוסד לימודים </label> <input class="form-control" type="text" name="school" placeholder="אוניברסטית בן גוריון" > <br>
                        
                        <label for="stud_year">שנת לימודים </label>
                        <select class="form-select" id="stud_year" name="stud_year">
                            <option value="" disabled selected>בחירת שנת לימודים</option>
                            <option value="1">א</option>
                            <option value="2">ב</option>
                            <option value="3">ג</option>
                            <option value="4">ד</option>
                        </select> <br>

                        <label> שכר לימודים </label> <input class="form-control" type="text" name="payment" placeholder="12,000" oninput="this.value = this.value.replace(/[^0-9]/g, '');" maxlength="5"> <br>
                        <label for="cert"> העלאת אישור לימודים </label> <input class="form-control" type="file" name="cert" style="width:50%"> <br>
                    </div>
                </div>
                
                <div class="col-sm-10">  <!-- third page -->
                    <div class="tab">
                        
                        <div class="row">
                            <div class="col-sm-6">
                                <br> <h3>העדפות</h3> 
                                <div class="form-check form-check-reverse">
                                    <input class="form-check-input" type="checkbox" value="" id="check1"> <label class="form-check-label" for="check1"> שומר שבת </label> <br>                                  
                                    <input class="form-check-input" type="checkbox" value="" id="check2"> <label class="form-check-label" for="check2"> שומר כשרות </label><br>
                                    <input class="form-check-input" type="checkbox" value="" id="check3"> <label class="form-check-label" for="check3">מעשן</label><br>
                                    <input class="form-check-input" type="checkbox" value="" id="check4"> <label class="form-check-label" for="check4">מגורים עם בעלי חיים</label><br>
                                </div> <br>
                                
                                <br> <h3>שפות דיבור</h3>
                                <div class="form-check form-check-reverse">
                                    <input class="form-check-input" type="checkbox" value="" id="check10"> <label class="form-check-label" for="check10"> עברית </label><br>
                                    <input class="form-check-input" type="checkbox" value="" id="check20"> <label class="form-check-label" for="check20">אנגלית</label><br>
                                    <input class="form-check-input" type="checkbox" value="" id="check30"><label class="form-check-label" for="check30">רוסית</label><br>
                                    <input class="form-check-input" type="checkbox" value="" id="check40"><label class="form-check-label" for="check40">ערבית</label><br>
                                    <input class="form-check-input" type="checkbox" value="" id="check50"><label class="form-check-label" for="check50">אחר</label><br>
                                </div>
                            </div>
                            
                            <div class="col-sm-6">
                                <br> <h3>מצב משפחתי</h3>
                                <div class=" form-check form-check-reverse">
                                    <input class="form-check-input" type="radio" value="" id="check100" name="status"> <label class="form-check-label" for="check100">רווק/ה</label><br>
                                    <input class="form-check-input" type="radio" value="" id="check200" name="status"> <label class="form-check-label" for="check200"> אלמן/ה</label><br>                                   
                                    <input class="form-check-input" type="radio" value="" id="check300" name="status"> <label class="form-check-label" for="check300">נשוי/ה</label><br>                                 
                                    <input class="form-check-input" type="radio" value="" id="check400" name="status"> <label class="form-check-label" for="check400">גרוש/ה </label><br>
                                    <input class="form-check-input" type="radio" value="" id="check500" name="status"> <label class="form-check-label" for="check500">אחר</label><br>
                                </div>
                            
                                <br> <h3> מגורים </h3>
                                <div class="form-check form-check-reverse">
                                    <input class="form-check-input" type="radio" value="" id="check1000" name="live"><label class="form-check-label" for="check1000">מלאים</label> <br>
                                    <input class="form-check-input" type="radio" value="" id="check2000" name="live"><label class="form-check-label" for="check2000">חלקיים (3 ימים בשבוע)</label>
                                </div> 
                            </div> 
                        </div> <br>

                    </div>
                </div>

                <div class="but">
                    <button type="button" id="prevBtn" class="my-button-class" onclick="nextPrev(-1)">הקודם</button>
                    <button type="button" id="nextBtn" class="my-button-class" onclick="nextPrev(1)">הבא</button>
                </div>

                <!-- Circles which indicates the steps of the form: -->
                <div style="text-align:center;margin-top:40px;">
                    <span class="step"></span>
                    <span class="step"></span>
                    <span class="step"></span>
                </div>

            </form> <br>
        </div>
    </main>

    <script>
        var select = document.querySelector('#stud_year');
      
        select.addEventListener('invalid', function() {
            this.setCustomValidity('אנא בחרו שנת לימודים');
        });

        // expression to match only letters (including Hebrew letters)- first name
        const firstnameInput = document.querySelector('input[name="firstname"]');

        firstnameInput.addEventListener('input', () => {
            const inputValue = firstnameInput.value.trim();
            const regex = /^[a-zA-Zא-ת]+$/; 
        
            if (!regex.test(inputValue)) {
                firstnameInput.classList.add('invalid');
            } 
            else {
                firstnameInput.classList.remove('invalid');
            }
        });

        // expression to match only letters (including Hebrew letters)- last name
        const lastnameInput = document.querySelector('input[name="lastname"]');

        lastnameInput.addEventListener('input', () => {
            const inputValue = lastnameInput.value.trim();

            if (!regex.test(inputValue)) {
                lastnameInput.classList.add('invalid');
            } 
            else {
                lastnameInput.classList.remove('invalid');
            }
        });
    
        var loadFile = function(event) {
            var image = document.getElementById('output');
            image.src = URL.createObjectURL(event.target.files[0]);
        };

        var currentTab = 0; // Current tab is set to be the first tab (0)
        showTab(currentTab); // Display the current tab
    
        function showTab(n) {
        // This function will display the specified tab of the form ...
            var x = document.getElementsByClassName("tab"); 
            x[n].style.display = "block"
            
            // ... and fix the Previous/Next buttons:
            if (n == 0) {
                document.getElementById("prevBtn").style.display = "none";
            } 
            else {
                document.getElementById("prevBtn").style.display = "inline";
            }
            if (n == (x.length - 1) || (currentTab == 2 && ! document.getElementById("studentCheckbox").checked)) {
                document.getElementById("nextBtn").innerHTML = "שמור";
            } 
            else {
                document.getElementById("nextBtn").innerHTML = "הבא";
            }
    
            // ... and run a function that displays the correct step indicator:
            fixStepIndicator(n)
        }
    
        function nextPrev(n) {
            // This function will figure out which tab to display
            var x = document.getElementsByClassName("tab");
            
            // Exit the function if any field in the current tab is invalid:
            if (n == 1 && !validateForm()) return false;
    
            // Validate passwords if moving to next tab
            if (n == 1 && !validatePasswords()) return false;
    
            // Hide the current tab:
            x[currentTab].style.display = "none";
    
            // Increase or decrease the current tab by 1:
            currentTab = currentTab + n;

            // if you have reached the end of the form... :
            if (currentTab >= x.length) {
            //...the form gets submitted:
                document.getElementById("regForm").submit();
                window.location.href = "index.html"; 
                return false;
            }
    
            // skip pages if not student 
            if (!document.getElementById("studentCheckbox").checked) {
                if (currentTab == 1){
                    currentTab = currentTab + n;
                }
            }
    
            // Otherwise, display the correct tab:
            showTab(currentTab);
        }
    
        function validateForm() {
            // This function deals with validation of the form fields
            var x, y, i, valid = true;
            x = document.getElementsByClassName("tab");
            y = x[currentTab].getElementsByTagName("input");

            // A loop that checks every input field in the current tab:
            for (i = 0; i < y.length; i++) {
                // If a field is empty...
                if (y[i].value == "" && y[i].hasAttribute(" ")) {
                    // add an "invalid" class to the field:
                    y[i].className += " invalid";
                    // and set the current valid status to false:
                    valid = false;
                }

                // If the input is an email address, validate it using the validateEmail function
                if (y[i].type == "email" && !validateEmail(y[i].value)) {
                    y[i].className += " invalid";
                    valid = false;
                }
            }

            // If the valid status is true, mark the step as finished and valid:
            if (valid) {
                document.getElementsByClassName("step")[currentTab].className += " finish";
            }
            return valid; // return the valid status
        }
    
        function validatePasswords() {
            var password = document.getElementsByName("password")[0].value;
            var confirm_password = document.getElementsByName("confirm_password")[0].value;
            if (password != confirm_password) {
                alert("Passwords do not match!");
                return false;
            }
            return true;
        }

        function validateEmail(email) {
            // regex for validating email addresses
            var emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;

            if (!emailRegex.test(email)) {
                alert("Please enter a valid email address!");
                return false;
            }
            return true;
        }

        // expression to match only letters (including Hebrew letters)- street
        const streetInput = document.querySelector('input[name="street"]');

        streetInput.addEventListener('input', () => {
            const inputValue = streetInput.value.trim();
            
            if (!regex.test(inputValue)) {
                streetInput.classList.add('invalid');
            } 
            else {
                streetInput.classList.remove('invalid');
            }
        });

        // expression to match only letters (including Hebrew letters)- school
        const schoolInput = document.querySelector('input[name="cschool"]');

        schoolInput.addEventListener('input', () => {
            const inputValue = schoolInput.value.trim();

            if (!regex.test(inputValue)) {
                schoolInput.classList.add('invalid');
            } 
            else {
                schoolInput.classList.remove('invalid');
            }
        });

        // expression to match only letters (including Hebrew letters)-cardname
        const cardnameInput = document.querySelector('input[name="cardname"]');
        
        cardnameInput.addEventListener('input', () => {
            const inputValue = cardnameInput.value.trim();
            
            if (!regex.test(inputValue)) {
                cardnameInput.classList.add('invalid');
            } 
            else {
                cardnameInput.classList.remove('invalid');
            }
        });
    
        // expression to match only letters (including Hebrew letters)- city
        const cityInput = document.querySelector('input[name="city"]');
        
        cityInput.addEventListener('input', () => {
            const inputValue = cityInput.value.trim();

            if (!regex.test(inputValue)) {
                cityInput.classList.add('invalid');
            } 
            else {
                cityInput.classList.remove('invalid');
            }
        });
    
        function fixStepIndicator(n) {
            // This function removes the "active" class of all steps...
            var i, x = document.getElementsByClassName("step");

            for (i = 0; i < x.length; i++) {
                x[i].className = x[i].className.replace(" active", "");
            }
            //... and adds the "active" class to the current step:
            x[n].className += " active";
        }

    </script>

</body>
</html>
